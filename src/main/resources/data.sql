USE greenroutine;
SET FOREIGN_KEY_CHECKS=0;

-- =========================
-- 초기화(내 유저와 해당 월만)
-- =========================
DELETE FROM save_width_bar   WHERE user_id=1 AND ym IN ('2025-08');
DELETE FROM save_length_bar  WHERE ym='2025-08' AND area='안서동';
DELETE FROM this_month_goal  WHERE user_id=1 AND period_ym='2025-08';
DELETE FROM saving_goal      WHERE user_id=1 AND period_ym='2025-08';
DELETE FROM monthly_charge   WHERE user_id=1 AND ym IN ('2025-07','2025-08');
DELETE FROM usage_log        WHERE user_id=1 AND DATE(ts)='2025-08-19';
DELETE FROM tip_rule;
DELETE FROM user_preference  WHERE user_id=1;
DELETE FROM alert            WHERE user_id=1
  AND created_at BETWEEN '2025-07-01 00:00:00' AND '2025-08-31 23:59:59';
DELETE FROM gr_user          WHERE id=1;

-- =========================
-- 사용자
-- =========================
INSERT INTO gr_user (id, email) VALUES (1, 'test@example.com');

-- =========================
-- 월별/일별 사용량 (원가 환산은 서비스에서 계산)
-- 7월: 전기 피크 + 가스도 사용
-- 8월: 7월 대비 15~20% 절약 패턴
-- =========================
INSERT INTO monthly_charge (user_id, ym, day_value, elec, gas) VALUES
-- 2025-07
(1,'2025-07', 1,12,3),(1,'2025-07', 2,11,2),(1,'2025-07', 3,15,4),
(1,'2025-07', 4,14,3),(1,'2025-07', 5,13,2),(1,'2025-07', 6,12,3),
(1,'2025-07', 7,13,2),(1,'2025-07', 8,12,3),(1,'2025-07', 9,14,4),
(1,'2025-07',10,13,2),(1,'2025-07',11,12,3),(1,'2025-07',12,15,4),
(1,'2025-07',13,14,2),(1,'2025-07',14,13,3),(1,'2025-07',15,12,2),
(1,'2025-07',16,13,3),(1,'2025-07',17,14,4),(1,'2025-07',18,15,3),
(1,'2025-07',19,12,2),(1,'2025-07',20,13,3),(1,'2025-07',21,14,2),
(1,'2025-07',22,13,3),(1,'2025-07',23,12,2),(1,'2025-07',24,15,4),
(1,'2025-07',25,14,3),(1,'2025-07',26,13,2),(1,'2025-07',27,12,3),
(1,'2025-07',28,13,2),(1,'2025-07',29,14,3),(1,'2025-07',30,12,2),
(1,'2025-07',31,13,3),
-- 2025-08 (1~25)
(1,'2025-08', 1,10,2),(1,'2025-08', 2, 9,1),(1,'2025-08', 3,11,2),
(1,'2025-08', 4,10,2),(1,'2025-08', 5, 9,1),(1,'2025-08', 6,10,2),
(1,'2025-08', 7,11,2),(1,'2025-08', 8,10,2),(1,'2025-08', 9, 9,1),
(1,'2025-08',10,10,2),(1,'2025-08',11,11,3),(1,'2025-08',12, 9,1),
(1,'2025-08',13,10,2),(1,'2025-08',14, 9,1),(1,'2025-08',15,10,2),
(1,'2025-08',16,11,2),(1,'2025-08',17,10,2),(1,'2025-08',18, 9,1),
(1,'2025-08',19,10,2),(1,'2025-08',20,11,3),(1,'2025-08',21,10,2),
(1,'2025-08',22, 9,1),(1,'2025-08',23,10,2),(1,'2025-08',24,11,2),
(1,'2025-08',25,10,2);

-- =========================
-- 도넛/가로바용 목표·진척 (SaveWidthBarService)
-- =========================
INSERT INTO save_width_bar (user_id, ym, category, target_amount, used_amount) VALUES
(1,'2025-08','elec',10000, 5380),
(1,'2025-08','gas' ,30000,20000);

-- =========================
-- 세로바/랭킹 (SaveLengthBarService)
-- =========================
INSERT INTO save_length_bar (user_id, area, ym, success_count, total_count) VALUES
(1,'안서동','2025-08',84,100),
(2,'안서동','2025-08',90,100),
(3,'안서동','2025-08',17,100),
(4,'안서동','2025-08',21,100),
(5,'안서동','2025-08',19,100),
(6,'안서동','2025-08',23,100);

-- =========================
-- 이번 달 목표(슬라이더) (ThisMonthGoalService)
-- =========================
INSERT INTO this_month_goal (user_id, period_ym, goal_won) VALUES
(1,'2025-08',50000);

-- =========================
-- 절약 목표(대시보드 카드) (DashboardService.set/getSavingGoal)
-- =========================
INSERT INTO saving_goal (user_id, period_ym, saving_goal_won) VALUES
(1,'2025-08',50000);

-- =========================
-- TipService용 선호 + 룰
-- =========================
INSERT INTO user_preference (user_id, housing_type, has_double_door, window_type)
VALUES (1, '원룸', 0, '단창');

-- 전기 TIP
INSERT INTO tip_rule (housing_type, has_double_door, window_type, utility, priority, message) VALUES
('원룸', 0, '단창', 'ELEC', 0, '단창이면 낮 일사 차단! 블라인드/암막으로 에어컨 효율 업 🌞'),
(NULL  ,NULL, NULL , 'ELEC', 1, '에어컨 26~27℃ + 선풍기 병행으로 체감온도만 낮추기 ❄️'),
(NULL  ,NULL, NULL , 'ELEC', 2, '대기전력 멀티탭 OFF로 전기 누수 컷 🔌');

-- 가스 TIP
INSERT INTO tip_rule (housing_type, has_double_door, window_type, utility, priority, message) VALUES
('원룸', NULL, NULL , 'GAS', 0, '보일러 외출/예약 모드로 불필요 가동 최소화 ⏱️'),
(NULL  ,NULL, '단창', 'GAS', 1, '창틀 틈 보수(실리콘/패킹)로 열손실 잡기 🔧'),
(NULL  ,NULL, NULL , 'GAS', 2, '온수는 가열 후 OFF, 샤워는 10분 내로 🚿');

-- =========================
-- MetricsService 라인차트(시연 하루치)
-- =========================
INSERT INTO usage_log (user_id, ts, elec, gas) VALUES
-- 00~05 저부하
(1,'2025-08-19 00:00:00', 1,0),
(1,'2025-08-19 01:00:00', 1,0),
(1,'2025-08-19 02:00:00', 0,0),
(1,'2025-08-19 03:00:00', 0,0),
(1,'2025-08-19 04:00:00', 0,0),
(1,'2025-08-19 05:00:00', 1,0),
-- 06~09 출근/샤워 피크 (가스↑)
(1,'2025-08-19 06:00:00', 1,1),
(1,'2025-08-19 07:00:00', 2,2),
(1,'2025-08-19 08:00:00', 2,2),
(1,'2025-08-19 09:00:00', 2,1),
-- 10~16 주간 전기↑
(1,'2025-08-19 10:00:00', 3,0),
(1,'2025-08-19 11:00:00', 4,0),
(1,'2025-08-19 12:00:00', 4,1),
(1,'2025-08-19 13:00:00', 4,0),
(1,'2025-08-19 14:00:00', 4,0),
(1,'2025-08-19 15:00:00', 4,0),
(1,'2025-08-19 16:00:00', 3,0),
-- 17~21 저녁 피크 (가스↑↑)
(1,'2025-08-19 17:00:00', 3,1),
(1,'2025-08-19 18:00:00', 4,2),
(1,'2025-08-19 19:00:00', 4,3),
(1,'2025-08-19 20:00:00', 3,2),
(1,'2025-08-19 21:00:00', 3,1),
-- 22~23 감소
(1,'2025-08-19 22:00:00', 2,0),
(1,'2025-08-19 23:00:00', 1,0);

-- =========================
-- Alert 샘플
-- =========================
INSERT INTO alert (user_id, category, level, title_exp, created_at, yes_read) VALUES
(1,'BILL','알림','8월 중간 정산 알림','2025-08-15 09:00:00', b'0'),
(1,'전기','경고','8/19 저녁 시간대 전력 급증 감지','2025-08-19 20:05:00', b'0');

SET FOREIGN_KEY_CHECKS=1;